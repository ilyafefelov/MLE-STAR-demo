% Final Thesis Draft — Automatic Pipeline Generation with Gemini & MLE-STAR

## 1. Abstract
This document presents experiments evaluating automatically generated ML pipelines from Gemini variants within the MLE-STAR ablation protocol. We compare the impact of pipeline building blocks, measure accuracy across standard datasets, and compare Gemini model variants.

## 2. Methodology
See `thesis_methodology.md` for details. Short summary: We used four datasets (`breast_cancer`, `wine`, `digits`, `iris`), tested six pipeline configurations (full, no_scaling, no_feature_engineering, no_tuning, no_ensemble, minimal), and executed repeated runs (n_runs up to 10) to estimate mean and variance. We used Gemini-generated pipeline functions from `model_comparison_results/*.py` and executed them by registering with `src/mle_star_ablation/mle_star_generated_pipeline.set_full_pipeline_callable()`.

## 3. Experiments & Results
Comprehensive results are in `reports/table1_model_comparison.csv` and `reports/table2_ablation.csv`. Figures are saved in `reports/figures`.

### Key observations:
- Gemini `pro` variants generally produced top mean accuracies for `wine`, `digits`, and `iris`.
- Feature scaling is crucial for `wine` and `breast_cancer` (SVC-like models are sensitive).
- For `digits` (high dimensional), feature engineering sometimes decreases performance; tuned models without additional feature transforms performed best.
- For `iris` (small dataset), results vary with sampling: some simpler pipelines outperform tuned pipelines due to variance.

### Statistical significance (examples):
- For `wine` (flash_lite pipeline, n=5): ANOVA: F=35.9460, p=2.1797e-10. The effect of disallowing scaling (`no_scaling`) significantly reduces performance.
- For `breast_cancer` (flash_lite pipeline, n=5): ANOVA: F=13.7386, p=2.1859e-06. `no_scaling` is significantly worse than other configurations.
- For `digits` (flash_lite pipeline, n=5 & n=10): strong evidence that `no_scaling` and `minimal` are worse than full/tuned pipelines.

## 4. Technical artifacts & reproducibility
- The generated pipelines used in experiments are stored under `model_comparison_results/`, named like `gemini_2.5_flash_lite_wine.py` and provide a `build_full_pipeline()` function.
- We executed these pipeline files directly in the ablation harness with the `--variant` flag; this registers and uses the Gemini-generated code at runtime.
- Command examples for reproduction are in `thesis_methodology.md`.

## 5. Discussion
We observe trade-offs: more sophisticated generators (`pro`) yield stronger performance on average but often at higher generation costs. Importantly, pipeline components like scaling and ensembling have dataset-dependent effects and are not uniformly helpful.

## 6. Conclusion
The experiments demonstrate that automatically generated pipelines from Gemini variants can be executed directly and assessed under a controlled ablation protocol. With careful registration and test harness, we verified that generated pipelines are production-like and can be integrated into MLE-STAR workflows.

## 7. Files & Outputs
- `reports/table1_model_comparison.csv` — Main summary comparing Gemini variants
- `reports/table2_ablation.csv` — Ablation study results per dataset/variant
- `reports/figures/*` — Visualizations used in the Results section
- `model_comparison_results/*` — The actual Gemini-generated pipeline code files (each provides `build_full_pipeline()`)

## 8. Figures & LaTeX tables
- Table 1 LaTeX: `reports/table1_model_comparison.tex` (generated by `scripts/export_tables_latex.py`)
- Table 2 LaTeX: `reports/table2_ablation.tex` (generated by `scripts/export_tables_latex.py`)
- Figures are saved to `reports/figures/` and include:
	- `model_comparison_barplot.png` — Bar chart comparing mean accuracies per dataset & variant
	- `ablation_<dataset>.png` — Per-dataset ablation bar plots (with CI bars)

## 9. Appendix: Reproducible Commands
Run all variant experiments with high repetitions (n_runs=10):
```pwsh
& "C:/Program Files/Python313/python.exe" scripts/run_experiments_variants.py --variants flash_lite,flash,pro --datasets breast_cancer,wine,digits,iris --n-runs 10 --output-dir results/variants_n10
```

Re-aggregate and clean results:
```pwsh
& "C:/Program Files/Python313/python.exe" scripts/aggregate_model_comparison.py --input-dir model_comparison_results --out reports/table1_model_comparison.csv
& "C:/Program Files/Python313/python.exe" scripts/aggregate_results.py --results-dir results --outdir reports
& "C:/Program Files/Python313/python.exe" scripts/clean_reports.py --reports reports
```

Export LaTeX tables and figures for final thesis inclusion:
```pwsh
& "C:/Program Files/Python313/python.exe" scripts/export_tables_latex.py --table1 reports/table1_model_comparison.csv --table2 reports/table2_ablation.csv --out reports
& "C:/Program Files/Python313/python.exe" scripts/generate_thesis_figures.py --table1 reports/table1_model_comparison.csv --table2 reports/table2_ablation.csv --out reports/figures
```

## 10. Annex — Strict confirmation
See `reports/confirmation.txt` and `reports/confirmation_sergeant.txt` for explicit verification logs stating Gemini-generated pipeline code was used and executed.

