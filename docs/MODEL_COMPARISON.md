# Порівняння моделей Gemini для генерації ML Pipeline

## Проблема rate limits

Під час тестування зіткнулися з обмеженнями безкоштовної квоти Gemini API:
- **Free tier limit**: 15 запитів на хвилину
- **Помилка**: `429 You exceeded your current quota`
- **Рішення**: Чекати 60+ секунд між запитами або використовувати платний тариф

## Доступні моделі Gemini (станом на 13.11.2025)

### 1. gemini-2.0-flash-exp
- **Тип**: Експериментальна, безкоштовна
- **Призначення**: Швидкі відповіді, прототипування
- **Ціна**: FREE (з rate limits)
- **Швидкість**: ~1-2 секунди
- **Якість**: Добра для більшості задач

### 2. gemini-2.5-flash  
- **Тип**: Стабільна Flash версія
- **Призначення**: Баланс швидкості та якості
- **Ціна**: ~$0.075 / 1M input tokens, $0.30 / 1M output tokens
- **Швидкість**: ~1-3 секунди
- **Якість**: Покращена відносно 2.0

### 3. gemini-2.5-pro
- **Тип**: Найрозумніша модель
- **Призначення**: Складні задачі, reasoning
- **Ціна**: ~$1.25 / 1M input tokens, $5.00 / 1M output tokens
- **Швидкість**: ~3-5 секунд
- **Якість**: Найвища, але дорожча

### 4. gemini-2.0-flash-thinking-exp
- **Тип**: Експериментальна з reasoning
- **Призначення**: Задачі що потребують ланцюжок міркувань
- **Ціна**: FREE (експериментальна)
- **Швидкість**: ~3-7 секунд (reasoning додає час)
- **Якість**: Висока для складних задач

## Попередні результати (breast_cancer dataset)

### Фактичні результати з gemini-2.0-flash-exp:

| Метрика | Значення |
|---------|----------|
| **Generation time** | ~2-3 секунди |
| **Accuracy** | 97.02% ± 0.78% |
| **Pipeline структура** | ✅ Preprocessor (Imputer + Scaler) + PCA + LogisticRegression |
| **Код якість** | ✅ Детальні коментарі, docstrings |
| **Hyperparameters** | ✅ solver='liblinear', random_state=42 |

## Рекомендації для дипломної роботи

### Аналіз потреб:

**Що потрібно для диплому:**
1. Генерація pipeline для 4 датасетів (breast_cancer, wine, digits, iris)
2. Ablation аналіз (6 configs × 5 runs × 5 folds = 150 експериментів на датасет)
3. Статистичний аналіз та візуалізація
4. Публікація у журналі

**Обсяг API запитів:**
- Генерація pipeline: **4 запити** (по одному на датасет)
- Тривалість: ~8-12 секунд з паузами
- Токени: ~500 input + ~1000 output на запит = **6000 токенів загалом**

### Порівняння варіантів:

#### Варіант 1: gemini-2.0-flash-exp (РЕКОМЕНДОВАНО ✅)
**Переваги:**
- ✅ Безкоштовно
- ✅ Достатньо швидко (1-2с на запит)
- ✅ Доведена якість (97% accuracy)
- ✅ Детальні коментарі в коді

**Недоліки:**
- ⚠️ Rate limits (15 req/min)
- ⚠️ Експериментальна (може змінитись)

**Вартість для диплому: $0.00**

#### Варіант 2: gemini-2.5-flash
**Переваги:**
- ✅ Стабільна версія
- ✅ Швидка (1-3с)
- ✅ Без rate limits
- ✅ Офіційна підтримка

**Недоліки:**
- ⚠️ Платна ($0.075/1M input)

**Вартість для диплому:**
- Input: 2000 tokens × 4 requests × $0.075/1M = **$0.0006**
- Output: 4000 tokens × 4 requests × $0.30/1M = **$0.0048**
- **Загалом: ~$0.005 (менше 1 цента)**

#### Варіант 3: gemini-2.5-pro
**Переваги:**
- ✅ Найвища якість
- ✅ Кращий reasoning
- ✅ Складні задачі

**Недоліки:**
- ⚠️ Дорожча (в 15-20 разів)
- ⚠️ Повільніша (3-5с)

**Вартість для диплому:**
- Input: 2000 × 4 × $1.25/1M = **$0.01**
- Output: 4000 × 4 × $5.00/1M = **$0.08**
- **Загалом: ~$0.09**

## Фінальна рекомендація

### ✅ Використовувати: gemini-2.0-flash-exp

**Обґрунтування:**
1. **Вартість**: Безкоштовно vs $0.005-$0.09 (несуттєво, але чому платити?)
2. **Якість**: Вже доведено 97% accuracy - достатньо для диплому
3. **Швидкість**: 1-2 секунди цілком прийнятно
4. **Rate limits**: Для 4 датасетів (4 запити з паузами 60с) - це ~3-4 хвилини загалом
5. **Код якість**: Gemini 2.0 вже генерує детальні коментарі та правильну структуру

### Коли варто розглянути платні версії:

❌ **НЕ варто** для цього диплому, тому що:
- Різниця в accuracy ймовірно < 1%
- Для 4 простих sklearn датасетів Flash достатньо
- Вартість хоч і мінімальна, але безсенсова

✅ **Варто розглянути** в майбутньому, якщо:
- Складні custom датасети з domain-specific знаннями
- Потрібна генерація складних ensemble методів
- Критична різниця в accuracy (медичні/фінансові застосування)
- Промислове використання з великою кількістю запитів

## План дій

1. ✅ **Залишити gemini-2.0-flash-exp**
2. ✅ **Згенерувати 4 pipeline** (breast_cancer вже є, залишилось 3)
3. ✅ **Провести ablation аналіз** на всіх 4 датасетах
4. ✅ **Зібрати статистику** та порівняти результати
5. ✅ **Додати в протокол** обґрунтування вибору моделі

## Висновок

Для дипломної роботи **gemini-2.0-flash-exp є оптимальним вибором**:
- Достатня якість (97% accuracy)
- Безкоштовна
- Швидка (1-2с)
- Rate limits не критичні для 4 запитів

Платні версії (2.5-flash, 2.5-pro) не дають значного покращення для простих sklearn датасетів, тому немає сенсу платити навіть мінімальну суму.

**Рішення: Продовжуємо з gemini-2.0-flash-exp ✅**

---

**Дата аналізу:** 13.11.2025  
**Автор:** Фефелов Ілля Олександрович
